5.  问题一模型的建立与求解

6.1数据侧写与预处理

先用筛选可能的异常值，主要包括负数供应量等。

6.1.1供给侧观察

提供不同材料商家的频率统计。由此可见*（可以换成一个饼状图）*提供A类材料的厂家最多，B、C材料提供厂家递次减少，但总体而言分布较为均匀。

在对每周的A、B、C类原材料供应需求量分别汇总。再进行描述性统计。

不同材料供货量的时间分布。A类材料供货量与C类材料供货量周期都在60-80周范围内且最值有较大波动，而B类材料供货量约20周/周期，季节性明显。

对于三种材料供货量的描述性统计

6.1.2需求侧观察

先看不同材料订货量的频率统计。A类材料供货量与C类材料供货量周期都在60-80周范围内且最值有较大波动，而B类材料供货量约20周/周期，季节性明显,且与供货量周期相近。这些说明，B类材料相对处于供需平衡的境地，而其他两类材料则可能面临着周期性的供不应求的问题。

不同材料订货量的时间分布

对于三种材料订货量的描述性统计

有效周分布如下图所示。也可以见得，季节性相当之明显。

6.1.3转运商相关数据

对转各个运商近240周损耗率数据进行统计性描述。

6.2问题一模型的建立

6.2.1确定评价指标

六项指标

  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  **特征维度**     **指标名称**       **计算公式**                               **指标意义（服务 "保障生产" 目标）**
  ---------------- ------------------ ------------------------------------------ --------------------------------------------------------------------------------------------------
  供需匹配度       累计供货率         对某供应商，仅计算**有效合作周**（订货量   反映供应商 "整体满足企业订货需求的能力"，越高越能减少缺货风险，是保障生产的基础。
                                      \> 0 的周）：\                             
                                      累计供货率 =（总供货量）/（总订货量）×100% 

  供货波动度       供货量变异系数     仅计算**有效合作周**：\                    消除量纲影响，量化供货量的波动程度，越小说明供货越稳定，企业库存规划越容易（避免库存骤高骤低）。
                                      变异系数                                   
                                      =（供货量标准差）/（供货量均值）×100%      

  履约意愿         订货响应率         订货响应率 =（供货量 \> 0                  反映供应商 "接到订单后的履约积极性"，100% 表示只要订货就供货，保障生产连续性。
                                      的周数）/（订货量 \> 0 的周数）×100%       

  产能价值         等效产能贡献       等效产能贡献 = 总供货量 × 材料系数（A      将不同材料的供货量统一转化为 "可支撑的产品产能"，直接关联企业 2.82 万 m³/
                                      类：1/0.6；B 类：1/0.66；C 类：1/0.72）    周的产能需求，体现供货的实际价值。

  合作连续性       最大连续供货周数   统计 "订货量\> 0 且供货量 \> 0"            连续供货周数越长，企业无需频繁切换供应商，减少供应链波动，降低断供风险。
                                      的连续周数最大值                           

  供需匹配稳定性   供需偏差波动率     仅计算**有效合作周**：\                    量化供需偏差（超供 /
                                      1. 单周偏差 Δ= 供货量 - 订货量\            缺供）的波动程度，越小说明供需关系越可预测，企业可精准规划库存（避免积压或断供）。
                                      2. 偏差波动率 = Var (Δ)（方差）            
  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

6.2.2熵权法确定权重

六项指标通过熵权法所得权重如下表。

6.2.3优劣解距离法排序

按得分高低排序前,五十家供应商如下表（也可以放到附件中看你咋选）

  -----------------------------------------------------------------------
  suppliers             material            ImportanceScore
  --------------------- ------------------- -----------------------------
  S229                  A                   0.918437

  S361                  C                   0.879396

  S108                  B                   0.812943

  S282                  A                   0.796287

  S275                  A                   0.789449

  S329                  A                   0.787653

  S340                  B                   0.786483

  S131                  B                   0.761558

  S268                  C                   0.751008

  S306                  C                   0.748321

  S356                  C                   0.746551

  S352                  A                   0.735321

  S151                  C                   0.733772

  S194                  C                   0.733637

  S330                  B                   0.732246

  S308                  B                   0.727491

  S143                  A                   0.71746

  S247                  C                   0.709181

  S140                  B                   0.708863

  S031                  B                   0.702823

  S284                  C                   0.700101

  S365                  C                   0.700002

  S040                  B                   0.693154

  S266                  A                   0.691375

  S294                  C                   0.69028

  S364                  B                   0.689749

  S346                  B                   0.687354

  S367                  B                   0.687329

  S218                  C                   0.687239

  S080                  C                   0.686251

  S123                  A                   0.684676

  S244                  C                   0.68245

  S007                  A                   0.679356

  S067                  C                   0.663811

  S055                  B                   0.657733

  S076                  C                   0.644913

  S189                  A                   0.643022

  S139                  B                   0.640978

  S338                  B                   0.639566

  S213                  C                   0.638516

  S314                  C                   0.637897

  S239                  C                   0.63289

  S174                  B                   0.631935

  S237                  A                   0.629497

  S092                  B                   0.62484

  S098                  B                   0.620359

  S005                  A                   0.616866

  S175                  B                   0.608166

  S178                  A                   0.604361

  S169                  B                   0.6037
  -----------------------------------------------------------------------

前50排名直方图如图所示。

[]{.mark}

[问题二模型的建立与求解]{.mark}

[本问旨在通过多目标优化模型，在满足生产需求的前提下，确定最优的供应商数量、订购方案和转运方案。模型的核心目标是最小化总成本和总损耗，并以此为基础对方案进行效果分析。]{.mark}

[7.1 模型构建]{.mark}

[本模型以保障生产为首要前提，将问题分解为"供应商选择"、"订购量优化"和"转运方案优化"三个子模块，构建一个线性规划模型。]{.mark}

[7.1.1 决策变量]{.mark}

[]{.mark}$\mathit{X}_{\mathit{it}}$[:
第i家供应商第t周的订购量（m^3^）。]{.mark}

[]{.mark}$\mathit{W}_{\mathit{itk}}$[:
第i家供应商第t周运给第k家转运商的供货量（m^3^）。]{.mark}

[]{.mark}$\mathit{I}_{\mathit{t}}$[:
第t周结束时的库存量（m^3^）。]{.mark}

[]{.mark}$\mathit{Y}_{\mathit{it}}$[:
第i家供应商第t周的实际供货量（m^3^）。]{.mark}

[7.1.2 目标函数]{.mark}

[本模型采用加权法将多目标优化问题转化为单目标问题，综合考虑总成本和总损耗。]{.mark}

[总成本：包括采购成本、运输成本和违约成本。]{.mark}

[采购成本：$$\sum_{i,t} X_{it} \times C_{it}^{purchase}$$]{.mark}

[运输成本：$$\sum_{i,t,k} W_{itk} \times C_k^{transport}$$]{.mark}

[违约成本：$$\sum_{i,t} \max(0, X_{it} - Y_{it}) \times C_{it}^{penalty}$$]{.mark}

[总损耗：$$\sum_{i,t,k} W_{itk} \times \text{loss\_rate}_{k,t}$$]{.mark}

[由于损耗直接转化为成本，因此将总损耗量乘以平均材料单价，纳入总成本考量。最终目标函数为：]{.mark}

[最小化 $$Z = \text{总成本} + \text{损耗折算成本}$$]{.mark}

[7.1.3 约束条件]{.mark}

[1. 产能约束：每周的可用原材料总量必须满足生产所需。]{.mark}

[$$\sum_i Y_{it} \times (1 - L_{it}) \geq (\text{每周产能} / \text{材料系数})$$]{.mark}

[2. 库存约束：任何时刻的库存都应能满足未来两周的生产需求。]{.mark}

[$$I_t \geq 2 \times (\text{周平均产能需求})$$]{.mark}

[3. 供货量与订购量关系：供货量是订购量与供货率的函数。]{.mark}

[$$Y_{it} = X_{it} \times \text{供货率}_i$$]{.mark}

[4. 转运商能力约束：每家转运商每周的转运总量不能超过其最大运力（6000m^3^周）。]{.mark}

[$$\sum_i W_{itk} \leq 6000$$]{.mark}

[5. 供应商选择约束：选择的供应商数量应为最少。]{.mark}

[通过引入二元变量 $Z_i$（1代表选择该供应商，0代表不选择），最小化 $$\sum_i Z_i$$。]{.mark}

[7.2 求解与分析]{.mark}

[我们使用Julia语言结合JuMP和GLPK求解器对模型进行求解。通过迭代的方式，我们首先确定了满足生产需求的最少供应商数量为50家。基于这50
家供应商，我们进一步求解了最优的订购和转运方案。]{.mark}

[7.2.1 生产保障效果]{.mark}

[我们验证了优化方案在生产保障方面的表现，具体结果如下：]{.mark}

[]{.mark}

[库存走势：如上图所示，在24周的计划期内，库存量始终保持在满足两周生产需求的底线（约9.4万m^3^）之上。这表明模型成功地通过调整订购量，有效应对了供货不确定性，避免了生产中断风险。]{.mark}

[产能达标率：根据方案，24周中每一周的实际可生产产品量均达到或超过2.82万m^3^的产能要求，产能达标率为100%。这远高于问题要求中"\>=95%"的门槛。]{.mark}

[库存达标率：在整个计划期内，所有24周的周末库存均高于下周初的库存底线，库存达标率为100%。这充分证明了方案的鲁棒性和可靠性。]{.mark}

[7.2.2 成本与损耗优化效果]{.mark}

[本方案在成本和损耗控制方面取得了显著成效：]{.mark}

[成本分析：]{.mark}

[通过筛选并仅使用50家供应商，我们大幅降低了供应商管理成本；方案优先向成本更低、供货更稳定的C类供应商倾斜，如上图所示，C类供应商在总订购量中占据了主导地位。这有效降低了原材料的平均采购成本。]{.mark}

[损耗分析：]{.mark}

[总损耗率：通过模型优化，最终方案的总损耗率为1.15%。相比总损耗率为1.62%的随机分配转运商的基准情况，本方案通过优先使用损耗率更低的转运商，使得总损耗降低了29%。直接降低了企业的运营成本。]{.mark}

[]{.mark}

[转运商分配：如上图所示，方案优先将大量的转运任务分配给了损耗率较低的转运商，其中T2、T6和T8三家转运商承担了绝大多数的转运量。这与模型最小化总损耗的目标相符，也说明了模型在转运决策上的有效性。]{.mark}

[7.3 结论]{.mark}

[综上所述，本模型成功地解决了问题二中的多目标优化问题。通过量化分析，我们不仅验证了方案在生产保障、成本控制和损耗优化方面的显著效果，也为企业提供了具体可行的24周订购和转运计划，具备极强的实用价值。]{.mark}
