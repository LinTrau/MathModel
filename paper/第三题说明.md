## 题目分析
**合格率i​=在第i个聚类中的总样本数量/在第i个聚类中Y染色体浓度≥4%的样本数量​**
>从统计学角度看，这个比例可以被视为在某一特定孕周和身体特征下，随机抽取一个孕妇，其Y染色体浓度合格的概率。
- 第二题目标：找到最早的达标时间。所以回归孕周并寻找最小值是合理的。
- 第三题目标：最大化达标比例。这是一个分类或概率问题，而不是一个连续值（如孕周）的回归问题。
>我们并没有直接将“合格率”作为聚类的因变量。这是因为，合格率本身是通过建模来优化的一个结果，而不是孕妇的固有属性。建模任务是**在每个聚类内部，寻找一个最佳的孕周，使其合格率达到最高。**又因为根据之前的数据处理和回归分析（以及临床常识），Y染色体浓度与孕周之间存在显著的正相关关系。那么找到浓度最高点，就等同于找到合格率最高点。因此，我们的目标不是简单地找到某个预测浓度达到最高值的点，而是寻找一个在满足达标条件前提下，尽可能早的检测时点。

## 预处理
从...中抽取各孕妇样本中abs(原始读段数 * （1 - 被过滤掉读段数的比例）* 在参考基因组上比对的比例 *（1 - 重复读段的比例）- 唯一比对的读段数) < 2的相关数据共447行。 

## 建模过程

### 1. 聚类+回归

#### 建模核心思路
- 检测误差降维：这5个指标（"孕妇BMI", "年龄", "身高", "体重", "测量误差（第二问的PC1～3）"）相互关联，直接放入模型会导致维度灾难和共线性问题。因此，我们将采用主成分分析（PCA）对其进行降维，提取出能代表“检测误差”的少数几个主成分，作为新的自变量加入回归模型。
- 多元局部加权回归：在每个DBSCAN聚类内部，构建一个以Y染色体浓度为因变量，以孕周、BMI、年龄、PCA主成分等为自变量的多元Loess模型。
- 寻找最佳时点：模型能预测出在特定孕周下，Y染色体浓度的期望值。我们将在预测曲线上寻找第一个预测浓度达到或超过4%的孕周。这既满足了“达标”的要求，又符合“尽早发现风险”的原则。

#### 1.1 DBSCAN
自变量向量维数7：4因子+3误差主成分  

#### 1.2 回归
自变量向量：6维*题目4因子+1孕周+1误差*,因变量：y浓度；  
约束：**Y浓度最大点且时间尽量早** => 目标：**浓度达标率最大的时间**  
*注*：julia不支持多元局部加权回归，仅有1维数据的支持，只好委曲求全了：我先尝试手动实现（称之为“局部加权最小二乘法”）不行就换

#### 论文描述方法
>“我们首先通过合格率定义来评估每个聚类的整体特征。然后，我们建立了一个能够预测连续Y染色体浓度的多元回归模型，并根据模型的预测结果来寻找最佳时点。我们基于‘平均浓度最高时，合格率最可能达到最高’的假设，利用模型找到了最佳时点。”  

1. 聚类结果分析：描述你的群体
首先，你需要描述你的聚类结果，这直接回答了“如何合理分组”的问题。*引用表格：使用 bmi_intervals.csv。*  
**分析要点：**  
- 聚类数量：根据表格，解释你的模型将孕妇分成了几个群体（通常是一个大群体和一些小群体/异常点）。
- 群体特征：描述每个聚类的人口统计学特征（平均BMI、年龄、身高和体重）。例如，“聚类1是一个包含423名孕妇的大群体，其平均BMI为32.34...”
- 同质性：重点指出，在考虑了所有因素后，大部分孕妇表现出高度的同质性。这能体现出你的多元模型分析的深入性，并解释为什么最终只分出少数几个聚类。
- 异常点：简要说明异常点（cluster = -1）的特点，并解释为什么这些数据点会被视为异常。
2. 回归模型分析：论证最佳时点  
这是你论文的核心论证部分。你需要证明，基于你的多元局部加权回归模型，你找到了每个群体的最佳NIPT时点。*引用表格：使用 optimal_gest_weeks.csv。*  
**分析要点：**
- 最佳时点：根据 optimal_gest_weeks.csv，列出每个聚类对应的最佳孕周。例如，“对于聚类1，模型预测的最高浓度出现在第25.0周，而对于聚类2，最佳时点为第12.8周。”
- 曲线趋势：结合 all_regression_curves.csv 中的数据，绘制每个聚类的Y染色体浓度随孕周变化的曲线图。在图上，标记出你找到的最佳孕周点。描述这些曲线的趋势：Y染色体浓度如何随孕周增长，何时达到峰值。
- 论证：解释为什么这些时点是“最佳”的。你可以强调，这些时点是在综合考虑了孕妇的BMI、年龄、身高、体重和检测误差等多个因素后得出的，这使得你的结果比仅考虑单一因素的模型更全面、更可靠。
3. 结果验证与风险分析  
这一部分将增强你论文的严谨性，并直接回应题目中“潜在风险最小”的要求。*引用表格：主要使用 bmi_intervals.csv 和你的回归曲线图。*  
**分析要点：**  
- 早期发现：根据你找到的最佳孕周，对照题目中给出的风险标准（12周以内风险低，13-27周风险高）。分析你的最佳时点是否符合“早期发现”的要求。
- 合格率：引用 bmi_intervals.csv 中的 qualification_rate 列。将你的结果与实际合格率进行对比。例如，“我们的模型预测的最佳时点（第X周）所对应的群体，其NIPT的实际合格率为Y%，这证明了该时点的有效性。”
- 检测误差影响：最后，分析你的PCA降维结果。你可以引用之前我们生成的 analysis_results2.csv（如果有的话）来解释第一主成分（PC1）主要代表了哪些检测误差指标，并说明你将这个综合误差指标纳入模型，使得结果更加稳健。

### 2. 误差分析